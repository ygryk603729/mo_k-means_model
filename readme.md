# Лабораторная работа: Сегментация клиентов онлайн-ретейла с помощью K-means

**Курс:** Машинное обучение, 4-й курс  
**Вариант:** Кластеризация клиентов методом K-means  
**Датасет:** Online Retail — транзакционные данные британского интернет-магазина подарков и товаров для дома (541 909 записей)

### Цель работы
Выполнить полный цикл анализа клиентской базы: разведочный анализ данных (EDA), построение RFM-признаков, кластеризацию клиентов алгоритмом K-means, выбор оптимального числа кластеров и визуальную интерпретацию полученных сегментов.

### Основные этапы
1. **Загрузка и первичный осмотр данных**  
2. **Очистка**: удаление отменённых заказов, отрицательных количеств/цен, строк без CustomerID, дубликатов  
3. **RFM-анализ** + дополнительные признаки (AvgOrderValue, TotalItems, UniqueProducts)  
4. **EDA**: распределения, корреляции, статистики, выявление выбросов  
5. **Предобработка**: capping (1–99 %), log1p-преобразование, стандартизация (StandardScaler)  
6. **Выбор числа кластеров**: Elbow-метод (Inertia) и Silhouette score для k = 2…11  
7. **Обучение K-means (k = 4)** — обоснованный выбор по балансу качества и интерпретируемости  
8. **Профилирование кластеров** и бизнес-интерпретация:  
   - Лояльные VIP  
   - Активные средние  
   - Редкие / Рисковые  
   - Спящие / Ушедшие  
9. **Визуализация кластеров** в 2D с помощью PCA и t-SNE  

### Ключевые результаты
- Выделено 4 чётко интерпретируемых клиентских сегмента из 4338 уникальных покупателей  
- Построены профили сегментов (средние Recency, Frequency, Monetary, средний чек)  
- Подготовлены рекомендации для маркетинга: персональные предложения, программы лояльности, win-back кампании  

### Используемые библиотеки
`pandas`, `numpy`, `matplotlib`, `seaborn`, `scikit-learn`

### Файлы
- `main.ipynb` — основной Jupyter-ноутбук с полным кодом и визуализациями  
- `Online_Retail_Customer_Segmentation_Final.xlsx` — итоговая таблица клиентов с метками кластеров  
- `rfm_final_ready_for_kmeans.csv` — подготовленные признаки для модели
